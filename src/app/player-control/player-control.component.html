<mat-toolbar class="player-control"
             color="primary"
             fxLayout="row"
             fxLayoutAlign="start center"
             fxLayoutGap="10px">

  <app-video (played)="updateTime($event)"></app-video>

  <div class="progress-wrapper">
    <app-track-progress [hidden]="!currentTrack"
                        [currentProgress]="currentTime"
                        (progressChange)="onTimeSelect($event)"
                        [progressLength]="trackLength">
    </app-track-progress>
  </div>

  <div fxFlex="30"
       class="player-left">
    <div class="thumbnail-wrapper"
         [matTooltip]="currentTrack?.fullname">
      <img [src]="getTrackThumb()">
    </div>
    <div class="track-label">
      {{currentTrack?.displayname || ''}}
    </div>
  </div>
  <div class="player-middle"
       fxFlex="40"
       fxLayout="row"
       fxLayoutAlign="space-between center"
       fxLayoutGap="5px">
    <button *ngIf="false"
            mat-icon-button
            [disabled]="!currentTrack">
      <fa-icon [icon]="faRedo"></fa-icon>
    </button>
    <button mat-icon-button
            [matMenuTriggerFor]="menu"
            [disabled]="!currentTrack ">
      <fa-icon [icon]="faDots"></fa-icon>
    </button>
    <mat-menu #menu="matMenu">
      <button mat-menu-item
              (click)="copyUrlClick()">
        <fa-icon class="menu-icon"
                 fixedWidth="true"
                 [icon]="faLink"></fa-icon>
        <span>Скопировать ссылку</span>
      </button>
      <!-- It seems like the button' [hidden] doesn't work for mat-menu-item -->
      <ng-container *ngIf="isNative">
        <button mat-menu-item
                (click)="saveVideo()">
          <fa-icon class="menu-icon"
                   fixedWidth="true"
                   [icon]="faSave"></fa-icon>
          <span>Сохранить ЦУИЬ</span>
        </button>
      </ng-container>
    </mat-menu>
    <button mat-icon-button
            [disabled]="!currentTrack"
            (click)="playPrev()">
      <fa-icon [icon]="faStepBack"></fa-icon>
    </button>
    <button mat-fab
            [disabled]="!currentTrack"
            (click)="play()">
      <fa-icon [icon]="isPlaying ? faPause : faPlay "></fa-icon>
    </button>
    <button mat-icon-button
            [disabled]="!currentTrack"
            (click)="playNext()">
      <fa-icon [icon]="faStepForw"></fa-icon>
    </button>
    <button mat-icon-button
            [disabled]="!currentTrack"
            (click)="toggleShuffle()">
      <fa-icon [ngStyle]="{'color': isShuffled ? '#ff4081' : ''}"
               [icon]="faRandom"></fa-icon>
    </button>
    <button mat-icon-button
            [disabled]="!currentTrack"
            (click)="toggleFullscreen()">
      <fa-icon [icon]="faFullscreen"></fa-icon>
    </button>
  </div>
  <div class="player-right"
       fxFlex="30"
       fxLayout="column"
       fxLayoutAlign="end end">
    <div fxFlex="25">
      <div class="time-label"
           [hidden]="!currentTrack">
        <span class="time-container-current">{{ currentTime | minuteSeconds }}</span>
        /
        <span class="time-container-current">{{ trackLength | minuteSeconds }}</span>
      </div>
    </div>
    <div fxFlex="75">
      <app-volume-slider></app-volume-slider>
    </div>
  </div>

</mat-toolbar>